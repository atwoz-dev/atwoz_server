# AWS ê°œë°œ ì„œë²„ êµ¬ì¶• ê°€ì´ë“œ (í•œêµ­ì–´íŒ)

> ì €ë¹„ìš© + ìš´ì˜ í™˜ê²½ê³¼ ë™ì¼í•œ êµ¬ì¡°ë¡œ ê°œë°œ ì„œë²„ êµ¬ì¶•í•˜ê¸°

## ëª©ì°¨

1. [ì‚¬ì „ ì¤€ë¹„](#1-ì‚¬ì „-ì¤€ë¹„)
2. [VPC ë° ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •](#2-vpc-ë°-ë³´ì•ˆ-ê·¸ë£¹-ì„¤ì •)
3. [RDS MySQL ìƒì„±](#3-rds-mysql-ìƒì„±)
4. [ElastiCache Redis ìƒì„±](#4-elasticache-redis-ìƒì„±)
5. [ECR ë¦¬í¬ì§€í† ë¦¬ ìƒì„±](#5-ecr-ë¦¬í¬ì§€í† ë¦¬-ìƒì„±)
6. [Route 53 ë„ë©”ì¸ ì„¤ì •](#6-route-53-ë„ë©”ì¸-ì„¤ì •)
7. [EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì„¤ì •](#7-ec2-ì¸ìŠ¤í„´ìŠ¤-ìƒì„±-ë°-ì„¤ì •)
8. [ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬](#8-ì• í”Œë¦¬ì¼€ì´ì…˜-ë°°í¬)
9. [Nginx + Let's Encrypt HTTPS ì„¤ì •](#9-nginx--lets-encrypt-https-ì„¤ì •)
10. [ë™ì‘ í™•ì¸ ë° í…ŒìŠ¤íŠ¸](#10-ë™ì‘-í™•ì¸-ë°-í…ŒìŠ¤íŠ¸)
11. [ë¬¸ì œ í•´ê²°](#11-ë¬¸ì œ-í•´ê²°)

---

## ì˜ˆìƒ ë¹„ìš©

| ë¦¬ì†ŒìŠ¤                         | ìŠ¤í™                    | ì›” ì˜ˆìƒ ë¹„ìš©   |
|-----------------------------|-----------------------|-----------|
| EC2 t4g.micro               | 1 vCPU, 1GB RAM       | $6        |
| RDS db.t4g.micro            | 1 vCPU, 1GB RAM, 20GB | $15       |
| ElastiCache cache.t4g.micro | 1 vCPU, 0.5GB RAM     | $11       |
| EBS 20GB gp3                | ìŠ¤í† ë¦¬ì§€                  | $2        |
| **í•©ê³„**                      |                       | **$34/ì›”** |

---

## 1. ì‚¬ì „ ì¤€ë¹„

### 1.1 IAM ê¶Œí•œ í™•ì¸

âš ï¸ **ê°€ì¥ ë¨¼ì € í™•ì¸!**

í˜„ì¬ **AdministratorAccess** ê¶Œí•œì´ ìˆìœ¼ì‹œë©´ â†’ **âœ… ëª¨ë“  ì‘ì—… ê°€ëŠ¥, ë‹¤ë¥¸ ê¶Œí•œ ë¶ˆí•„ìš”!**

í™•ì¸ ë°©ë²•:

1. AWS ì½˜ì†” ìš°ì¸¡ ìƒë‹¨ â†’ ê³„ì • ì´ë¦„ í´ë¦­ â†’ ë³´ì•ˆ ìê²© ì¦ëª…
2. IAM â†’ ì‚¬ìš©ì â†’ [ë³¸ì¸ ê³„ì •] â†’ ê¶Œí•œ íƒ­

### 1.2 í•„ìˆ˜ ë„êµ¬

**ë°˜ë“œì‹œ í•„ìš”:**

- [x] ì›¹ ë¸Œë¼ìš°ì €
- [x] SSH í´ë¼ì´ì–¸íŠ¸ (macOSëŠ” í„°ë¯¸ë„ ë‚´ì¥)
- [x] Docker (`docker --version` í™•ì¸)

**ì„ íƒì‚¬í•­:**

- [ ] AWS CLI (ì—†ì–´ë„ ë¨)

---

## 2. VPC ë° ë³´ì•ˆ ê·¸ë£¹ ì„¤ì •

### ğŸ’¡ VPCë€?

**VPC = ë‹¹ì‹ ë§Œì˜ ë…ë¦½ëœ ë„¤íŠ¸ì›Œí¬ ê³µê°„**

```
ì¸í„°ë„·
  â”‚
  â””â”€â”€ VPC (ë‹¹ì‹ ì˜ ì•„íŒŒíŠ¸ ë‹¨ì§€)
      â”œâ”€â”€ ì„œë¸Œë„· A (ê³µê°œ ì˜ì—­) â†’ EC2
      â””â”€â”€ ì„œë¸Œë„· B (ë¹„ê³µê°œ ì˜ì—­) â†’ RDS, Redis
```

- **ê¸°ë³¸ VPC**: AWS ê³„ì • ë§Œë“¤ë©´ ìë™ ìƒì„±ë¨
- **ê¶Œì¥**: ê¸°ë³¸ VPC ê·¸ëŒ€ë¡œ ì‚¬ìš© (ìƒˆë¡œ ë§Œë“¤ í•„ìš” ì—†ìŒ!)

---

### 2.1 VPC í™•ì¸

**AWS ì½˜ì†” â†’ VPC â†’ Virtual Private Cloud ë©”ë‰´ì—ì„œ "VPC" í´ë¦­**

ê¸°ë³¸ VPC ID í™•ì¸ (ì˜ˆ: vpc-0abc123def456)
â†’ ë‚˜ì¤‘ì— ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ **ë©”ëª¨**

---

### ğŸ’¡ ë³´ì•ˆ ê·¸ë£¹ì´ë€?

**ë³´ì•ˆ ê·¸ë£¹ = ê°€ìƒ ë°©í™”ë²½**

```
ì¸í„°ë„·
  â”‚
  â”œâ”€ í—ˆìš© âœ… (í¬íŠ¸ 22, SSH)
  â”œâ”€ í—ˆìš© âœ… (í¬íŠ¸ 8080, API)
  â””â”€ ì°¨ë‹¨ âŒ (ê·¸ ì™¸ ëª¨ë“  í¬íŠ¸)
     â†“
   EC2 ì„œë²„
```

**ë¹„ìœ : ì•„íŒŒíŠ¸ ê²½ë¹„ì‹¤**

- ì¸ë°”ìš´ë“œ ê·œì¹™ = ëˆ„ê°€ ë“¤ì–´ì˜¬ ìˆ˜ ìˆëŠ”ê°€?
- ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ = ëˆ„ê°€ ë‚˜ê°ˆ ìˆ˜ ìˆëŠ”ê°€?
- í¬íŠ¸ = ì¶œì…ë¬¸ ë²ˆí˜¸ (22ë²ˆ ì¶œì…ë¬¸, 8080ë²ˆ ì¶œì…ë¬¸ ë“±)

**ì™œ í•„ìš”í•œê°€ìš”?**

- í•´ì»¤ê°€ í•¨ë¶€ë¡œ ì ‘ê·¼ ëª»í•˜ê²Œ ë§‰ìŒ
- í•„ìš”í•œ í†µì‹ ë§Œ í—ˆìš© (ìµœì†Œ ê¶Œí•œ ì›ì¹™)

---

### 2.2 ë³´ì•ˆ ê·¸ë£¹ ìƒì„±

#### 2.2.1 EC2 ë³´ì•ˆ ê·¸ë£¹ ë§Œë“¤ê¸°

**AWS ì½˜ì†” â†’ EC2 â†’ ë„¤íŠ¸ì›Œí¬ ë° ë³´ì•ˆ â†’ ë³´ì•ˆ ê·¸ë£¹ â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±**

```
ë³´ì•ˆ ê·¸ë£¹ ì´ë¦„: atwoz-dev-ec2-sg
ì„¤ëª…: atwoz ê°œë°œ ì„œë²„ìš© EC2 ë³´ì•ˆ ê·¸ë£¹
VPC: [ìœ„ì—ì„œ í™•ì¸í•œ VPC ì„ íƒ]
```

**ì¸ë°”ìš´ë“œ ê·œì¹™ (ë“¤ì–´ì˜¤ëŠ” íŠ¸ë˜í”½):**

ê·œì¹™ 1:

```
ìœ í˜•: SSH
í”„ë¡œí† ì½œ: TCP
í¬íŠ¸ ë²”ìœ„: 22
ì†ŒìŠ¤: 0.0.0.0/0
ì„¤ëª…: SSH ì ‘ì†ìš© (í‚¤ ì¸ì¦ë§Œ ì‚¬ìš©)
```

ê·œì¹™ 2:

```
ìœ í˜•: HTTPS
í”„ë¡œí† ì½œ: TCP
í¬íŠ¸ ë²”ìœ„: 443
ì†ŒìŠ¤: 0.0.0.0/0
ì„¤ëª…: HTTPS ì›¹ íŠ¸ë˜í”½
```

ê·œì¹™ 3 (ì„ íƒì‚¬í•­):

```
ìœ í˜•: ì‚¬ìš©ì ì§€ì • TCP
í”„ë¡œí† ì½œ: TCP
í¬íŠ¸ ë²”ìœ„: 8080
ì†ŒìŠ¤: 0.0.0.0/0
ì„¤ëª…: ì§ì ‘ API í…ŒìŠ¤íŠ¸ìš© (HTTPS ì‚¬ìš© ì‹œ ì„ íƒì‚¬í•­)
```

âš ï¸ **ì°¸ê³ **: HTTPS (443)ë¡œ ì ‘ê·¼í•  ì˜ˆì •ì´ë¯€ë¡œ 8080 í¬íŠ¸ëŠ” ì„ íƒì‚¬í•­ì…ë‹ˆë‹¤. ê°œë°œ/í…ŒìŠ¤íŠ¸ í¸ì˜ë¥¼ ìœ„í•´ ì—´ì–´ë‘˜ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ (ë‚˜ê°€ëŠ” íŠ¸ë˜í”½):**

```
ê¸°ë³¸ê°’ ìœ ì§€ (ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš©)
```

**â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„± í´ë¦­!**

ìƒì„± í›„ ë³´ì•ˆ ê·¸ë£¹ ID í™•ì¸ (ì˜ˆ: sg-0abc123) â†’ **ë©”ëª¨**

---

#### 2.2.2 RDS ë³´ì•ˆ ê·¸ë£¹ ë§Œë“¤ê¸°

**AWS ì½˜ì†” â†’ EC2 â†’ ë„¤íŠ¸ì›Œí¬ ë° ë³´ì•ˆ â†’ ë³´ì•ˆ ê·¸ë£¹ â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±**

```
ë³´ì•ˆ ê·¸ë£¹ ì´ë¦„: atwoz-dev-rds-sg
ì„¤ëª…: atwoz ê°œë°œ ì„œë²„ìš© RDS ë³´ì•ˆ ê·¸ë£¹
VPC: [ë™ì¼í•œ VPC ì„ íƒ]
```

**ì¸ë°”ìš´ë“œ ê·œì¹™:**

```
ìœ í˜•: MYSQL/Aurora
í”„ë¡œí† ì½œ: TCP
í¬íŠ¸ ë²”ìœ„: 3306
ì†ŒìŠ¤: [ì‚¬ìš©ì ì§€ì •] â†’ [ìœ„ì—ì„œ ë§Œë“  EC2 ë³´ì•ˆ ê·¸ë£¹ ID ì…ë ¥: sg-0abc123]
ì„¤ëª…: EC2ì—ì„œë§Œ ì ‘ê·¼ í—ˆìš©
```

**â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„± í´ë¦­!**

---

#### 2.2.3 Redis ë³´ì•ˆ ê·¸ë£¹ ë§Œë“¤ê¸°

**AWS ì½˜ì†” â†’ EC2 â†’ ë„¤íŠ¸ì›Œí¬ ë° ë³´ì•ˆ â†’ ë³´ì•ˆ ê·¸ë£¹ â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„±**

```
ë³´ì•ˆ ê·¸ë£¹ ì´ë¦„: atwoz-dev-redis-sg
ì„¤ëª…: atwoz ê°œë°œ ì„œë²„ìš© Redis ë³´ì•ˆ ê·¸ë£¹
VPC: [ë™ì¼í•œ VPC ì„ íƒ]
```

**ì¸ë°”ìš´ë“œ ê·œì¹™:**

```
ìœ í˜•: ì‚¬ìš©ì ì§€ì • TCP
í”„ë¡œí† ì½œ: TCP
í¬íŠ¸ ë²”ìœ„: 6379
ì†ŒìŠ¤: [ì‚¬ìš©ì ì§€ì •] â†’ [EC2 ë³´ì•ˆ ê·¸ë£¹ ID: sg-0abc123]
ì„¤ëª…: EC2ì—ì„œë§Œ ì ‘ê·¼ í—ˆìš©
```

**â†’ ë³´ì•ˆ ê·¸ë£¹ ìƒì„± í´ë¦­!**

---

### 2.3 ë³´ì•ˆ ê·¸ë£¹ ì„¤ì • ì´ìœ 

#### ğŸ’¡ ì™œ ì´ë ‡ê²Œ ì„¤ì •í•˜ë‚˜ìš”?

í˜„ì¬ ë³´ì•ˆ ê·¸ë£¹ êµ¬ì¡°ëŠ” **ë‹¤ì¸µ ë°©ì–´(Defense in Depth)** ì „ëµì„ ë”°ë¦…ë‹ˆë‹¤:

```
ì¸í„°ë„·
  â”‚
  â”œâ”€ SSH (22) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> [EC2 ë³´ì•ˆê·¸ë£¹] âœ… ë‚´ IPë§Œ
  â”œâ”€ API (8080) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> [EC2 ë³´ì•ˆê·¸ë£¹] âœ… ëª¨ë“  IP
  â”‚                              â”‚
  â”‚                              â”œâ”€> MySQL (3306) â”€â”€> [RDS ë³´ì•ˆê·¸ë£¹] âœ…
  â”‚                              â””â”€> Redis (6379) â”€â”€> [Redis ë³´ì•ˆê·¸ë£¹] âœ…
  â”‚
  â”œâ”€ MySQL (3306) ì§ì ‘ â”€â”€> [RDS ë³´ì•ˆê·¸ë£¹] âŒ ì°¨ë‹¨!
  â””â”€ Redis (6379) ì§ì ‘ â”€â”€> [Redis ë³´ì•ˆê·¸ë£¹] âŒ ì°¨ë‹¨!
```

#### 1. EC2 ë³´ì•ˆê·¸ë£¹

**SSH (22ë²ˆ í¬íŠ¸) - ë‚´ IPë§Œ í—ˆìš©í•˜ëŠ” ì´ìœ :**

- SSHëŠ” ì„œë²„ì— ì§ì ‘ ì ‘ì†í•˜ëŠ” **ê´€ë¦¬ì í†µë¡œ**
- IPë¥¼ ì œí•œí•˜ë©´ ì „ ì„¸ê³„ì—ì„œ ì˜¤ëŠ” **ë¬´ì‘ìœ„ ê³µê²©(brute force)**ì„ ì›ì²œ ì°¨ë‹¨
- ë¹„ìœ : ì§‘ ì—´ì‡ ë¥¼ ì•„ë¬´ì—ê²Œë‚˜ ì£¼ì§€ ì•ŠëŠ” ê²ƒê³¼ ê°™ìŒ

**API (8080ë²ˆ í¬íŠ¸) - ëª¨ë“  IP í—ˆìš©í•˜ëŠ” ì´ìœ :**

- ì•±/í”„ë¡ íŠ¸ì—”ë“œê°€ APIë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ë¯€ë¡œ **ì™¸ë¶€ ì ‘ì† í•„ìš”**
- ì¸ì¦ì€ JWT í† í°ìœ¼ë¡œ ì²˜ë¦¬ (ëˆ„êµ¬ë‚˜ ë¬¸ì€ ì—´ ìˆ˜ ìˆì§€ë§Œ, í† í° ì—†ìœ¼ë©´ ì‚¬ìš© ë¶ˆê°€)
- ë¹„ìœ : ì€í–‰ ATM - ëˆ„êµ¬ë‚˜ ì ‘ê·¼ ê°€ëŠ¥, í•˜ì§€ë§Œ ì¹´ë“œ+ë¹„ë°€ë²ˆí˜¸ í•„ìš”

#### 2. RDS/Redis ë³´ì•ˆê·¸ë£¹ - EC2 ë³´ì•ˆê·¸ë£¹ë§Œ í—ˆìš©

**í•µì‹¬ ì›ë¦¬: "ë¦¬ì…‰ì…˜ì„ ê±°ì³ì•¼ë§Œ ê¸ˆê³ ì— ì ‘ê·¼ ê°€ëŠ¥"**

```
ì™¸ë¶€ ê³µê²©ì
  â”‚
  â”œâ”€ EC2 ì ‘ê·¼ ì‹œë„
  â”‚   â”œâ”€ SSH ì°¨ë‹¨ âŒ (IP ì œí•œ)
  â”‚   â””â”€ 8080 ì ‘ê·¼ ì„±ê³µ âœ… (í•˜ì§€ë§Œ JWT ì—†ìœ¼ë©´ ë¬´ìš©ì§€ë¬¼)
  â”‚
  â””â”€ DB ì§ì ‘ ì ‘ê·¼ ì‹œë„
      â””â”€ ì°¨ë‹¨ âŒ (EC2 ë³´ì•ˆê·¸ë£¹ë§Œ í—ˆìš©)
```

**ì™œ ì¤‘ìš”í•œê°€ìš”?**

ë§Œì•½ RDSë¥¼ ëª¨ë“  IPì— ì—´ì–´ë‘”ë‹¤ë©´:

1. ê³µê²©ìê°€ MySQL ë¹„ë°€ë²ˆí˜¸ë§Œ íƒˆì·¨í•˜ë©´ â†’ **ì¦‰ì‹œ DB í„¸ë¦¼** ğŸ”¥
2. DBì— ì§ì ‘ ì ‘ì† â†’ **ëª¨ë“  ë°ì´í„° ìœ ì¶œ/ì‚­ì œ ê°€ëŠ¥** ğŸ”¥

EC2ë¥¼ ê±°ì³ì•¼ë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë©´:

1. ê³µê²©ìëŠ” **EC2 SSH + DB ë¹„ë°€ë²ˆí˜¸ ë‘˜ ë‹¤** ëš«ì–´ì•¼ í•¨ (2ì¤‘ ì ê¸ˆ ğŸ”’ğŸ”’)
2. SSHê°€ IPë¡œ ì œí•œë˜ì–´ ìˆì–´ì„œ â†’ **ì²« ë²ˆì§¸ ê´€ë¬¸ë¶€í„° ë§‰í˜**

**ì‹¤ì œ ì‚¬ë¡€:**

```
ë³´ì•ˆ ê·¸ë£¹ ì˜ëª» ì„¤ì •í•œ ê²½ìš°:
- RDSë¥¼ 0.0.0.0/0 (ëª¨ë“  IP)ì— ì—´ì–´ë‘ 
- ë¹„ë°€ë²ˆí˜¸ íƒˆì·¨ (phishing, í‚¤ë¡œê±° ë“±)
â†’ ì „ ì„¸ê³„ ì–´ë””ì„œë“  DB ì ‘ì† ê°€ëŠ¥
â†’ ë°ì´í„° ìœ ì¶œ ì‚¬ê³  ë°œìƒ!

ì˜¬ë°”ë¥¸ ì„¤ì • (í˜„ì¬):
- RDSëŠ” EC2 ë³´ì•ˆê·¸ë£¹ë§Œ í—ˆìš©
- ê³µê²©ìëŠ” EC2 SSHë¥¼ ë¨¼ì € ëš«ì–´ì•¼ í•¨
â†’ SSHëŠ” IP ì œí•œ + í‚¤ íŒŒì¼ í•„ìš”
â†’ í›¨ì”¬ ì•ˆì „!
```

---

### 2.4 ë‹¤ì¤‘ ê°œë°œì SSH ì ‘ì† ì„¤ì •

#### í˜„ì¬ ë¬¸ì œ

- EC2 ë³´ì•ˆê·¸ë£¹ì˜ SSH ê·œì¹™ì´ **"ë‚´ IP"ë§Œ í—ˆìš©**
- ë‹¤ë¥¸ ê°œë°œìë“¤ì€ SSH ì ‘ì† ë¶ˆê°€

#### í•´ê²° ë°©ë²• (3ê°€ì§€ ì˜µì…˜)

---

#### ì˜µì…˜ A: ê° ê°œë°œì IP ì¶”ê°€ (ì¶”ì²œ â­)

**ì–¸ì œ ì‚¬ìš©:**

- ê°œë°œìê°€ ê³ ì • IPë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° (ì‚¬ë¬´ì‹¤, ê³ ì • ì¸í„°ë„·)
- ìµœê³  ìˆ˜ì¤€ì˜ ë³´ì•ˆì´ í•„ìš”í•œ ê²½ìš°

**ì„¤ì • ë°©ë²•:**

1. **ê° ê°œë°œìì˜ IP í™•ì¸**
    - ë¸Œë¼ìš°ì €ì—ì„œ https://whatismyipaddress.com/ ì ‘ì†
    - ë˜ëŠ” í„°ë¯¸ë„ì—ì„œ: `curl ifconfig.me`

2. **EC2 ë³´ì•ˆ ê·¸ë£¹ ìˆ˜ì •**
    - AWS ì½˜ì†” â†’ EC2 â†’ ë³´ì•ˆ ê·¸ë£¹ â†’ atwoz-dev-ec2-sg
    - ì¸ë°”ìš´ë“œ ê·œì¹™ í¸ì§‘

3. **SSH ê·œì¹™ì— IP ì¶”ê°€**

```
ê·œì¹™ 1 (ê¸°ì¡´):
  ìœ í˜•: SSH
  í¬íŠ¸: 22
  ì†ŒìŠ¤: 123.45.67.89/32  (ê°œë°œì1 IP)
  ì„¤ëª…: ê°œë°œì1 SSH ì ‘ì†

ê·œì¹™ 2 (ì¶”ê°€):
  ìœ í˜•: SSH
  í¬íŠ¸: 22
  ì†ŒìŠ¤: 234.56.78.90/32  (ê°œë°œì2 IP)
  ì„¤ëª…: ê°œë°œì2 SSH ì ‘ì†

ê·œì¹™ 3 (ì¶”ê°€):
  ìœ í˜•: SSH
  í¬íŠ¸: 22
  ì†ŒìŠ¤: 345.67.89.01/32  (ê°œë°œì3 IP)
  ì„¤ëª…: ê°œë°œì3 SSH ì ‘ì†
```

**ì¥ì :**

- âœ… ê°€ì¥ ì•ˆì „
- âœ… ì¶”ê°€ ë¹„ìš© ì—†ìŒ
- âœ… ê´€ë¦¬ ê°„ë‹¨ (AWS ì½˜ì†”ì—ì„œ í´ë¦­ ëª‡ ë²ˆ)

**ë‹¨ì :**

- âŒ IPê°€ ë°”ë€Œë©´ ë§¤ë²ˆ ìˆ˜ì • í•„ìš” (ì¹´í˜, ì¬íƒ ë“±)

**íŒ:**

```bash
# ê°œë°œìë“¤ì´ IP ì‰½ê²Œ í™•ì¸í•˜ë„ë¡ ìŠ¤í¬ë¦½íŠ¸ ì œê³µ
echo "ë‹¹ì‹ ì˜ IP: $(curl -s ifconfig.me)"
```

---

#### ì˜µì…˜ B: ëª¨ë“  IP í—ˆìš© + SSH í‚¤ ì¸ì¦ë§Œ ì‚¬ìš© (ê°„í¸)

**ì–¸ì œ ì‚¬ìš©:**

- ê°œë°œìë“¤ì´ ë‹¤ì–‘í•œ ì¥ì†Œì—ì„œ ì‘ì—… (ì¬íƒ, ì¹´í˜ ë“±)
- IP ê´€ë¦¬ê°€ ë²ˆê±°ë¡œìš´ ê²½ìš°

**ì„¤ì • ë°©ë²•:**

1. **ë³´ì•ˆ ê·¸ë£¹ ìˆ˜ì •**

```
SSH ê·œì¹™:
  ìœ í˜•: SSH
  í¬íŠ¸: 22
  ì†ŒìŠ¤: 0.0.0.0/0  (ëª¨ë“  IP)
  ì„¤ëª…: SSH í‚¤ ì¸ì¦ë§Œ í—ˆìš©
```

2. **EC2ì—ì„œ ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ ë¹„í™œì„±í™” (í•„ìˆ˜!)**

SSH ì ‘ì† í›„:

```bash
# SSH ì„¤ì • íŒŒì¼ í™•ì¸
sudo cat /etc/ssh/sshd_config | grep PasswordAuthentication

# ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ë¹„í™œì„±í™” (ì´ë¯¸ ë¹„í™œì„±í™”ë˜ì–´ ìˆì„ ê²ƒ)
# PasswordAuthentication no ì¸ì§€ í™•ì¸

# ë§Œì•½ yesë¡œ ë˜ì–´ ìˆë‹¤ë©´:
sudo vi /etc/ssh/sshd_config
# PasswordAuthentication no ë¡œ ë³€ê²½

# SSH ì¬ì‹œì‘
sudo systemctl restart sshd
```

3. **ê° ê°œë°œìì—ê²Œ SSH í‚¤ íŒŒì¼(.pem) ê³µìœ **

```bash
# ë³´ì•ˆ ì±„ë„ë¡œ ê³µìœ  (Slack DM, ì•”í˜¸í™” ë©”ì¼ ë“±)
# atwoz-dev-keypair.pem íŒŒì¼ ì „ë‹¬
```

**ì¥ì :**

- âœ… IP ê´€ë¦¬ ë¶ˆí•„ìš”
- âœ… ì–´ë””ì„œë“  ì ‘ì† ê°€ëŠ¥
- âœ… SSH í‚¤ë§Œ ìˆìœ¼ë©´ ì•ˆì „ (ë¹„ë°€ë²ˆí˜¸ ì—†ìŒ)

**ë‹¨ì :**

- âŒ SSH í‚¤ íŒŒì¼ ìœ ì¶œ ì‹œ ìœ„í—˜ (í•˜ì§€ë§Œ IP ì œí•œë³´ë‹¤ëŠ” í¸ë¦¬í•¨)

**ë³´ì•ˆ ê°•í™” íŒ:**

```bash
# ê° ê°œë°œìë³„ SSH í‚¤ í˜ì–´ ìƒì„± (ë” ì•ˆì „)
# EC2ì—ì„œ authorized_keysì— ê° ê°œë°œì ê³µê°œí‚¤ ì¶”ê°€

# ê°œë°œì1 í‚¤ ìƒì„± (ë¡œì»¬)
ssh-keygen -t rsa -f ~/.ssh/atwoz-dev1

# ê°œë°œì1 ê³µê°œí‚¤ë¥¼ EC2ì— ì¶”ê°€
# EC2ì—ì„œ:
echo "ssh-rsa AAAAB3Nza...ê°œë°œì1ê³µê°œí‚¤..." >> ~/.ssh/authorized_keys
```

---

#### ì˜µì…˜ C: íšŒì‚¬/VPN IP ëŒ€ì—­ í—ˆìš©

**ì–¸ì œ ì‚¬ìš©:**

- íšŒì‚¬ ì‚¬ë¬´ì‹¤ IPê°€ ê³ ì •ëœ ê²½ìš°
- VPNì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°

**ì„¤ì • ë°©ë²•:**

```
SSH ê·œì¹™:
  ìœ í˜•: SSH
  í¬íŠ¸: 22
  ì†ŒìŠ¤: 123.45.0.0/16  (íšŒì‚¬ IP ëŒ€ì—­)
  ì„¤ëª…: íšŒì‚¬ ë„¤íŠ¸ì›Œí¬ì—ì„œë§Œ ì ‘ì†
```

**ì¥ì :**

- âœ… ê°œë³„ IP ê´€ë¦¬ ë¶ˆí•„ìš”
- âœ… íšŒì‚¬ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œë§Œ ì ‘ì† ê°€ëŠ¥ (ì•ˆì „)

**ë‹¨ì :**

- âŒ ì¬íƒê·¼ë¬´ ì‹œ VPN í•„ìˆ˜

---

#### ì¶”ì²œ ì†”ë£¨ì…˜ ìš”ì•½

| ìƒí™©            | ì¶”ì²œ ì˜µì…˜                       | ì´ìœ            |
|---------------|-----------------------------|--------------|
| ê°œë°œ ì„œë²„, 2-3ëª… íŒ€ | **ì˜µì…˜ A** (ê°œë³„ IP ì¶”ê°€)         | ê°€ì¥ ì•ˆì „, ê´€ë¦¬ ê°„ë‹¨ |
| ê°œë°œì 5ëª… ì´ìƒ     | **ì˜µì…˜ B** (0.0.0.0/0 + í‚¤ ì¸ì¦) | IP ê´€ë¦¬ ë¶€ë‹´ ê°ì†Œ  |
| íšŒì‚¬ ì‚¬ë¬´ì‹¤        | **ì˜µì…˜ C** (íšŒì‚¬ IP ëŒ€ì—­)         | ìµœì            |
| ì¬íƒ + ì‚¬ë¬´ì‹¤ í˜¼í•©   | **ì˜µì…˜ A + VPN** ë˜ëŠ” **ì˜µì…˜ B**  | ìƒí™©ì— ë”°ë¼       |

---

#### ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì–´ë–¤ ì˜µì…˜ì„ ì„ íƒí•˜ë“  ê¼­ í™•ì¸:

- [ ] **SSH ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ë¹„í™œì„±í™”** (í‚¤ ì¸ì¦ë§Œ ì‚¬ìš©)
- [ ] **SSH í‚¤ íŒŒì¼ ê¶Œí•œ í™•ì¸** (`chmod 400 atwoz-dev-keypair.pem`)
- [ ] **í‚¤ íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ê³µìœ ** (ì•”í˜¸í™” ë©”ì¼, ë¹„ë°€ ì±„ë„)
- [ ] **í‡´ì‚¬ì í‚¤ ì œê±°** (ì •ê¸°ì ìœ¼ë¡œ authorized_keys ì ê²€)
- [ ] **CloudWatch ë¡œê·¸ë¡œ SSH ì ‘ì† ê¸°ë¡ ëª¨ë‹ˆí„°ë§** (ì„ íƒì‚¬í•­)

---

## 3. RDS MySQL ìƒì„±

### ğŸ’¡ RDSë€?

**RDS = Relational Database Service (ê´€ë¦¬í˜• ë°ì´í„°ë² ì´ìŠ¤)**

```
ë¡œì»¬ ê°œë°œ                AWS RDS
MySQL (Docker)          MySQL (AWS ê´€ë¦¬)
  â†“                        â†“
ë§¤ë²ˆ ì„¤ì¹˜/ì„¤ì •           ìë™ ë°±ì—… âœ…
ìˆ˜ë™ ë°±ì—…               ìë™ íŒ¨ì¹˜ âœ…
ì§ì ‘ ê´€ë¦¬               ëª¨ë‹ˆí„°ë§ âœ…
```

**ë¹„ìœ : í˜¸í…” vs ìê°€**

- **ë¡œì»¬ MySQL (Docker)**: ìê°€ (ì§ì ‘ ê´€ë¦¬)
- **RDS**: í˜¸í…” (AWSê°€ ê´€ë¦¬, ë‚˜ëŠ” ì‚¬ìš©ë§Œ)

**ì™œ RDSë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?**

- âœ… **ìë™ ë°±ì—…**: ë§¤ì¼ ìë™ìœ¼ë¡œ ë°±ì—…ë¨
- âœ… **ìë™ íŒ¨ì¹˜**: ë³´ì•ˆ ì—…ë°ì´íŠ¸ ìë™ ì ìš©
- âœ… **ê³ ê°€ìš©ì„±**: Multi-AZë¡œ ì´ì¤‘í™” ê°€ëŠ¥
- âœ… **ëª¨ë‹ˆí„°ë§**: CloudWatchë¡œ ìë™ ëª¨ë‹ˆí„°ë§
- âœ… **í™•ì¥ ìš©ì´**: í´ë¦­ ëª‡ ë²ˆìœ¼ë¡œ ìŠ¤í™ ì—…ê·¸ë ˆì´ë“œ

---

**AWS ì½˜ì†” â†’ RDS â†’ ë°ì´í„°ë² ì´ìŠ¤ â†’ ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±**

### 3.1 ê¸°ë³¸ ì„¤ì •

```
ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± ë°©ì‹: í‘œì¤€ ìƒì„±
ì—”ì§„ ì˜µì…˜: MySQL
ì—ë””ì…˜: MySQL Community
ì—”ì§„ ë²„ì „: MySQL 8.0.xx (ìµœì‹  ë²„ì „)
```

### 3.2 í…œí”Œë¦¿

```
í…œí”Œë¦¿: í”„ë¦¬ í‹°ì–´ (ë˜ëŠ” ê°œë°œ/í…ŒìŠ¤íŠ¸)
```

### 3.3 ì„¤ì •

```
DB ì¸ìŠ¤í„´ìŠ¤ ì‹ë³„ì: atwoz-dev-db

ìê²© ì¦ëª… ì„¤ì •:
  ë§ˆìŠ¤í„° ì‚¬ìš©ì ì´ë¦„: admin
  ìê²© ì¦ëª… ê´€ë¦¬: ìì²´ ê´€ë¦¬
  ë§ˆìŠ¤í„° ì•”í˜¸: [ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥]
  ì•”í˜¸ í™•ì¸: [ë™ì¼í•˜ê²Œ ì…ë ¥]
```

âš ï¸ **ë¹„ë°€ë²ˆí˜¸ë¥¼ ê¼­ ë©”ëª¨í•˜ì„¸ìš”!**

### 3.4 ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„±

```
DB ì¸ìŠ¤í„´ìŠ¤ í´ë˜ìŠ¤: ë²„ìŠ¤í„°ë¸” í´ë˜ìŠ¤ (t í´ë˜ìŠ¤ í¬í•¨)
  â†’ db.t4g.micro (1 vCPU, 1 GiB)

ìŠ¤í† ë¦¬ì§€:
  ìŠ¤í† ë¦¬ì§€ ìœ í˜•: ë²”ìš© SSD (gp3)
  í• ë‹¹ëœ ìŠ¤í† ë¦¬ì§€: 20 GiB
  ìŠ¤í† ë¦¬ì§€ ìë™ ì¡°ì • í™œì„±í™”: ì²´í¬ í•´ì œ (ë¹„ìš© ì ˆê°)
```

### 3.5 ì—°ê²°

```
ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤: EC2 ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ì— ì—°ê²° ì•ˆ í•¨

ë„¤íŠ¸ì›Œí¬ ìœ í˜•: IPv4

VPC: [ì„ íƒí•œ VPC]

DB ì„œë¸Œë„· ê·¸ë£¹: ìë™ ìƒì„± ë˜ëŠ” ê¸°ì¡´ ì„ íƒ

í¼ë¸”ë¦­ ì•¡ì„¸ìŠ¤: ì•„ë‹ˆìš”

VPC ë³´ì•ˆ ê·¸ë£¹:
  ê¸°ì¡´ í•­ëª© ì„ íƒ
  â†’ atwoz-dev-rds-sg ì„ íƒ
  â†’ default ë³´ì•ˆ ê·¸ë£¹ ì œê±°

ê°€ìš© ì˜ì—­: ê¸°ë³¸ ì„¤ì • ì—†ìŒ

ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸: 3306
```

### 3.6 ì¶”ê°€ êµ¬ì„±

**"ì¶”ê°€ êµ¬ì„±" í¼ì¹˜ê¸°**

```
ì´ˆê¸° ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„: atwoz_dev

DB íŒŒë¼ë¯¸í„° ê·¸ë£¹: ê¸°ë³¸ê°’

ë°±ì—…:
  ìë™ ë°±ì—… í™œì„±í™”: ì²´í¬
  ë°±ì—… ë³´ì¡´ ê¸°ê°„: 7ì¼

ì•”í˜¸í™”:
  ì•”í˜¸í™” í™œì„±í™”: ì²´í¬
  ë§ˆìŠ¤í„° í‚¤: (ê¸°ë³¸ê°’) aws/rds

ì„±ëŠ¥ ê°œì„  ë„ìš°ë¯¸: í™œì„±í™” ì•ˆ í•¨ (ë¹„ìš© ì ˆê°)

Enhanced ëª¨ë‹ˆí„°ë§: í™œì„±í™” ì•ˆ í•¨

ì¶”ê°€ ë¡œê·¸:
  ì¼ë°˜ ë¡œê·¸: ì²´í¬ (ì„ íƒì‚¬í•­)
  ëŠë¦° ì¿¼ë¦¬ ë¡œê·¸: ì²´í¬ (ì„ íƒì‚¬í•­)

ìœ ì§€ ê´€ë¦¬:
  ë§ˆì´ë„ˆ ë²„ì „ ìë™ ì—…ê·¸ë ˆì´ë“œ í™œì„±í™”: ì²´í¬
```

**â†’ ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± í´ë¦­!**

â± ì•½ 5-10ë¶„ ì†Œìš”

### 3.7 ì—”ë“œí¬ì¸íŠ¸ í™•ì¸

ìƒì„± ì™„ë£Œ í›„:

1. RDS â†’ ë°ì´í„°ë² ì´ìŠ¤ â†’ atwoz-dev-db í´ë¦­
2. "ì—°ê²° & ë³´ì•ˆ" íƒ­
3. **ì—”ë“œí¬ì¸íŠ¸** ë³µì‚¬ (ì˜ˆ: atwoz-dev-db.xxxxxx.ap-northeast-2.rds.amazonaws.com)
4. **ë©”ëª¨í•´ë‘ê¸°**

---

## 4. ElastiCache Redis ìƒì„±

### ğŸ’¡ ElastiCache Redisë€?

**ElastiCache = ê´€ë¦¬í˜• ì¸ë©”ëª¨ë¦¬ ìºì‹œ**

```
ìºì‹œ ì—†ìŒ                ìºì‹œ ìˆìŒ
DB ì§ì ‘ ì¡°íšŒ            Redis ë¨¼ì € í™•ì¸
  â†“ ëŠë¦¼ (100ms)          â†“ ë¹ ë¦„ (1ms)
ë§¤ë²ˆ DB ë¶€í•˜            DB ë¶€í•˜ ê°ì†Œ âœ…
```

**ë¹„ìœ : ì±…ìƒ ì„œë**

- **DB (RDS)**: ì±…ì¥ (ëŠë¦¬ì§€ë§Œ ëª¨ë“  ë°ì´í„° ë³´ê´€)
- **Cache (Redis)**: ì±…ìƒ ìœ„ (ë¹ ë¥´ì§€ë§Œ ìì£¼ ì“°ëŠ” ê²ƒë§Œ)

**ì™œ Redisë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?**

- âœ… **ì†ë„**: DBë³´ë‹¤ 100ë°° ë¹ ë¦„
- âœ… **ì„¸ì…˜ ì €ì¥**: ë¡œê·¸ì¸ ìƒíƒœ ìœ ì§€
- âœ… **API ì‘ë‹µ ìºì‹±**: ë°˜ë³µ ì¡°íšŒ ì„±ëŠ¥ í–¥ìƒ
- âœ… **ì‹¤ì‹œê°„ ë°ì´í„°**: ìˆœìœ„, ì¢‹ì•„ìš” ìˆ˜ ë“±

**ì™œ ElastiCacheë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?**

- Docker Redisì²˜ëŸ¼ ì§ì ‘ ê´€ë¦¬ ì•ˆ í•´ë„ ë¨
- ìë™ ë°±ì—…, ìë™ ì¥ì•  ë³µêµ¬
- ëª¨ë‹ˆí„°ë§ ìë™ ì œê³µ

---

**AWS ì½˜ì†” â†’ ElastiCache â†’ Redis ìºì‹œ â†’ Redis ìºì‹œ ìƒì„±**

### 4.1 í´ëŸ¬ìŠ¤í„° ëª¨ë“œ

```
í´ëŸ¬ìŠ¤í„° ëª¨ë“œ: ë¹„í™œì„±í™”ë¨
```

### 4.2 í´ëŸ¬ìŠ¤í„° ì •ë³´

```
ì´ë¦„: atwoz-dev-redis
ì„¤ëª…: atwoz ê°œë°œ ì„œë²„ìš© Redis

ì—”ì§„ ë²„ì „: 7.x (ìµœì‹ )
íŒŒë¼ë¯¸í„° ê·¸ë£¹: default.redis7
ë…¸ë“œ ìœ í˜•: cache.t4g.micro
ë³µì œë³¸ ìˆ˜: 0 (ë¹„ìš© ì ˆê°)
```

### 4.3 ì—°ê²°

```
ì„œë¸Œë„· ê·¸ë£¹:
  ìƒˆë¡œ ìƒì„± ë˜ëŠ” ê¸°ì¡´ ì„ íƒ

  ìƒˆë¡œ ìƒì„±í•˜ëŠ” ê²½ìš°:
    ì´ë¦„: atwoz-dev-redis-subnet-group
    VPC: [ì„ íƒí•œ VPC]
    ì„œë¸Œë„·: ìµœì†Œ 2ê°œ ì„ íƒ (ì„œë¡œ ë‹¤ë¥¸ ê°€ìš© ì˜ì—­)

ë³´ì•ˆ:
  ë³´ì•ˆ ê·¸ë£¹: atwoz-dev-redis-sg ì„ íƒ

ì•”í˜¸í™”:
  ì „ì†¡ ì¤‘ ì•”í˜¸í™”: í™œì„±í™”
  ì €ì¥ ì‹œ ì•”í˜¸í™”: í™œì„±í™” (ì„ íƒì‚¬í•­)

ì¸ì¦: Redis AUTH ê¸°ë³¸ ì‚¬ìš©ì ì•¡ì„¸ìŠ¤: ë¹„í™œì„±í™”
```

### 4.4 ë°±ì—…

```
ìë™ ë°±ì—… í™œì„±í™”: ì²´í¬
ë°±ì—… ë³´ì¡´ ê¸°ê°„: 1ì¼
```

**â†’ ìƒì„± í´ë¦­!**

â± ì•½ 5-10ë¶„ ì†Œìš”

### 4.5 ì—”ë“œí¬ì¸íŠ¸ í™•ì¸

1. ElastiCache â†’ Redis ìºì‹œ â†’ atwoz-dev-redis
2. **ê¸°ë³¸ ì—”ë“œí¬ì¸íŠ¸** ë³µì‚¬ (ì˜ˆ: atwoz-dev-redis.xxxxxx.cache.amazonaws.com)
3. **ë©”ëª¨í•´ë‘ê¸°**

---

## 5. ECR ë¦¬í¬ì§€í† ë¦¬ ìƒì„±

### ğŸ’¡ ECRì´ë€?

**ECR = Elastic Container Registry (Docker ì´ë¯¸ì§€ ì €ì¥ì†Œ)**

```
ë¡œì»¬                ECR               EC2
Docker ì´ë¯¸ì§€  â†’  ì—…ë¡œë“œ (push)  â†’  ë‹¤ìš´ë¡œë“œ (pull)
(ë¹Œë“œ)              (ì €ì¥ì†Œ)          (ì‹¤í–‰)
```

**ë¹„ìœ : GitHub vs ECR**

- **GitHub**: ì½”ë“œ ì €ì¥ì†Œ
- **ECR**: Docker ì´ë¯¸ì§€ ì €ì¥ì†Œ

**ì™œ ECRì„ ì‚¬ìš©í•˜ë‚˜ìš”?**

- âœ… **ì•ˆì „í•œ ì €ì¥**: í”„ë¼ì´ë¹— ì´ë¯¸ì§€ ë³´ê´€
- âœ… **AWS í†µí•©**: EC2, ECSì—ì„œ ë¹ ë¥´ê²Œ ë‹¤ìš´ë¡œë“œ
- âœ… **ë²„ì „ ê´€ë¦¬**: latest, v1.0.0 ë“± íƒœê·¸ ê´€ë¦¬
- âœ… **ë³´ì•ˆ ìŠ¤ìº”**: ì·¨ì•½ì  ìë™ ê²€ì‚¬ ê°€ëŠ¥

**íë¦„:**

1. ë¡œì»¬ì—ì„œ ì´ë¯¸ì§€ ë¹Œë“œ: `docker build`
2. ECRì— ì—…ë¡œë“œ: `docker push`
3. EC2ì—ì„œ ë‹¤ìš´ë¡œë“œ: `docker pull`
4. ì‹¤í–‰: `docker-compose up`

---

**AWS ì½˜ì†” â†’ ECR â†’ í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ â†’ ë¦¬í¬ì§€í† ë¦¬ â†’ ë¦¬í¬ì§€í† ë¦¬ ìƒì„±**

### 5.1 ì„¤ì •

```
ê°€ì‹œì„± ì„¤ì •: í”„ë¼ì´ë¹—

ë¦¬í¬ì§€í† ë¦¬ ì´ë¦„: atwoz/dev

íƒœê·¸ ë³€ê²½ ë¶ˆê°€: ë¹„í™œì„±í™”ë¨

í‘¸ì‹œí•  ë•Œ ìŠ¤ìº”: í™œì„±í™” (ì„ íƒì‚¬í•­)

KMS ì•”í˜¸í™”: ë¹„í™œì„±í™” (ë¹„ìš© ì ˆê°)
```

**â†’ ë¦¬í¬ì§€í† ë¦¬ ìƒì„± í´ë¦­!**

### 5.2 URI í™•ì¸

ìƒì„± í›„ ë¦¬í¬ì§€í† ë¦¬ URI ë³µì‚¬ (ì˜ˆ: 123456789012.dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev)
â†’ **ë©”ëª¨í•´ë‘ê¸°**

---

## 6. Route 53 ë„ë©”ì¸ ì„¤ì •

### ğŸ’¡ Route 53ì´ë€?

**Route 53 = AWSì˜ DNS ì„œë¹„ìŠ¤**

```
ì‚¬ìš©ìê°€ dev.atwoz.com ì…ë ¥
  â†“
Route 53 DNS ì¡°íšŒ
  â†“
EC2 Elastic IP ì£¼ì†Œ ë°˜í™˜ (ì˜ˆ: 3.35.123.45)
  â†“
ë¸Œë¼ìš°ì €ê°€ EC2 ì„œë²„ë¡œ HTTPS ìš”ì²­
```

**ë¹„ìœ : ì „í™”ë²ˆí˜¸ë¶€**

- **ë„ë©”ì¸ (dev.atwoz.com)**: ì‚¬ëŒ ì´ë¦„
- **IP ì£¼ì†Œ (3.35.123.45)**: ì „í™”ë²ˆí˜¸
- **Route 53**: ì´ë¦„ì„ ë³´ê³  ì „í™”ë²ˆí˜¸ë¥¼ ì°¾ì•„ì£¼ëŠ” ì„œë¹„ìŠ¤

**ì™œ ë„ë©”ì¸ì´ í•„ìš”í•œê°€ìš”?**

- âœ… **ê¸°ì–µí•˜ê¸° ì‰¬ì›€**: `dev.atwoz.com` vs `3.35.123.45`
- âœ… **SSL ì¸ì¦ì„œ**: Let's Encrypt ë¬´ë£Œ ì¸ì¦ì„œ ì‚¬ìš© ê°€ëŠ¥
- âœ… **ì „ë¬¸ì„±**: IP ì£¼ì†Œë³´ë‹¤ ì‹ ë¢°ê°
- âœ… **IP ë³€ê²½ ëŒ€ì‘**: EC2 IPê°€ ë°”ë€Œì–´ë„ DNSë§Œ ì—…ë°ì´íŠ¸

---

### 6.1 ë„ë©”ì¸ í™•ì¸

ì´ë¯¸ ë„ë©”ì¸ì´ ìˆëŠ” ê²½ìš°, 2ê°€ì§€ ì˜µì…˜:

#### ì˜µì…˜ A: ê¸°ì¡´ ë„ë©”ì¸ ì—…ì²´ì—ì„œ ê´€ë¦¬ (ì˜ˆ: GoDaddy, Namecheap)

- Route 53ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ê¸°ì¡´ ì—…ì²´ DNS ì„¤ì •ì—ì„œ A ë ˆì½”ë“œë§Œ ì¶”ê°€
- **ì¥ì **: ê¸°ì¡´ ë°©ì‹ ìœ ì§€, ì¶”ê°€ ë¹„ìš© ì—†ìŒ
- **ë‹¨ì **: AWSì™€ ë³„ë„ ê´€ë¦¬

#### ì˜µì…˜ B: Route 53ìœ¼ë¡œ ì´ì „ (ê¶Œì¥)

- ê¸°ì¡´ ë„ë©”ì¸ì„ Route 53ìœ¼ë¡œ ë„¤ì„ì„œë²„ ë³€ê²½
- **ì¥ì **: AWSì—ì„œ í†µí•© ê´€ë¦¬, ìë™í™” ìš©ì´
- **ë‹¨ì **: Route 53 ë¹„ìš© ($0.50/ì›”)

**ì–´ë–¤ ì˜µì…˜ì„ ì„ íƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?**

- ì´ ê°€ì´ë“œëŠ” **ì˜µì…˜ B (Route 53 ì‚¬ìš©)**ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë©ë‹ˆë‹¤
- ì˜µì…˜ Aë¥¼ ì›í•˜ì‹œë©´ ì„¹ì…˜ 6.4ë¡œ ê±´ë„ˆë›°ì„¸ìš”

---

### 6.2 Route 53 í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„±

âš ï¸ **ì£¼ì˜**: ë„ë©”ì¸ì€ **ì´ë¯¸ ì†Œìœ **í•˜ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤. ë„ë©”ì¸ì´ ì—†ë‹¤ë©´ ë¨¼ì € êµ¬ë§¤í•˜ì„¸ìš”.

**AWS ì½˜ì†” â†’ Route 53 â†’ í˜¸ìŠ¤íŒ… ì˜ì—­ â†’ í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„±**

```
ë„ë©”ì¸ ì´ë¦„: atwoz.com  (ë³¸ì¸ ë„ë©”ì¸ ì…ë ¥)
ìœ í˜•: í¼ë¸”ë¦­ í˜¸ìŠ¤íŒ… ì˜ì—­
```

**â†’ í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„± í´ë¦­**

ìƒì„± í›„ **ë„¤ì„ì„œë²„(NS) ë ˆì½”ë“œ** í™•ì¸:

```
ns-123.awsdns-12.com
ns-456.awsdns-34.net
ns-789.awsdns-56.org
ns-012.awsdns-78.co.uk
```

â†’ **ë©”ëª¨í•´ë‘ê¸°** (ë‹¤ìŒ ë‹¨ê³„ì—ì„œ ì‚¬ìš©)

---

### 6.3 ë„ë©”ì¸ ë„¤ì„ì„œë²„ ë³€ê²½

ê¸°ì¡´ ë„ë©”ì¸ ë“±ë¡ ì—…ì²´ (GoDaddy, Namecheap, Gabia ë“±)ì—ì„œ:

1. **ë„ë©”ì¸ ê´€ë¦¬ í˜ì´ì§€** ì ‘ì†
2. **ë„¤ì„ì„œë²„ (Nameservers) ì„¤ì •** ì°¾ê¸°
3. **ì‚¬ìš©ì ì •ì˜ ë„¤ì„ì„œë²„**ë¡œ ë³€ê²½
4. Route 53ì—ì„œ ë°›ì€ **4ê°œì˜ NS ë ˆì½”ë“œ** ì…ë ¥:

```
ns-123.awsdns-12.com
ns-456.awsdns-34.net
ns-789.awsdns-56.org
ns-012.awsdns-78.co.uk
```

5. **ì €ì¥**

â± **ì „íŒŒ ì‹œê°„**: ìµœëŒ€ 48ì‹œê°„ (ë³´í†µ 1-2ì‹œê°„)

**í™•ì¸ ë°©ë²•:**

```bash
# macOS/Linux
nslookup -type=NS atwoz.com

# ë˜ëŠ”
dig NS atwoz.com
```

ì¶œë ¥ì— awsdnsê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì„±ê³µ!

---

### 6.4 A ë ˆì½”ë“œ ìƒì„± (ì„œë¸Œë„ë©”ì¸ â†’ EC2 ì—°ê²°)

âš ï¸ **ì¤‘ìš”**: EC2 Elastic IPë¥¼ ë¨¼ì € í• ë‹¹ë°›ì•„ì•¼ í•©ë‹ˆë‹¤ (ì„¹ì…˜ 7.8 ì°¸ê³ )

ì´ ë‹¨ê³„ëŠ” **EC2 ìƒì„± ë° Elastic IP í• ë‹¹ í›„**ì— ì§„í–‰í•˜ì„¸ìš”.

**Route 53 â†’ í˜¸ìŠ¤íŒ… ì˜ì—­ â†’ [ë³¸ì¸ ë„ë©”ì¸] â†’ ë ˆì½”ë“œ ìƒì„±**

```
ë ˆì½”ë“œ ì´ë¦„: dev  (dev.atwoz.com ì„ ë§Œë“¤ë ¤ë©´)
ë ˆì½”ë“œ ìœ í˜•: A
ê°’: [EC2 Elastic IP ì£¼ì†Œ]  (ì˜ˆ: 3.35.123.45)
TTL: 300
ë¼ìš°íŒ… ì •ì±…: ë‹¨ìˆœ ë¼ìš°íŒ…
```

**â†’ ë ˆì½”ë“œ ìƒì„± í´ë¦­**

**í…ŒìŠ¤íŠ¸:**

```bash
# DNS ì¡°íšŒ
nslookup dev.atwoz.com

# HTTP ì ‘ê·¼ í…ŒìŠ¤íŠ¸ (Nginx ì„¤ì • í›„)
curl http://dev.atwoz.com:8080/actuator/health
```

---

## 7. EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì„¤ì •

### ğŸ’¡ EC2ë€?

**EC2 = Elastic Compute Cloud (ê°€ìƒ ì„œë²„)**

```
ë‚´ ì»´í“¨í„°                EC2 ì„œë²„
ë¡œì»¬ ê°œë°œ í™˜ê²½          í´ë¼ìš°ë“œ ì„œë²„
  â†“                       â†“
ì¸í„°ë„· ì—°ê²° í•„ìš”        24ì‹œê°„ ì‹¤í–‰ âœ…
ì „ê¸°ì„¸ ë‚˜ê°             ì‚¬ìš©í•œ ë§Œí¼ë§Œ ê³¼ê¸ˆ âœ…
ê³ ì¥ë‚˜ë©´ ë             ì¥ì•  ë³µêµ¬ ê°€ëŠ¥ âœ…
```

**ë¹„ìœ : ë‚´ ì»´í“¨í„° vs í´ë¼ìš°ë“œ**

- **ë¡œì»¬ ì»´í“¨í„°**: ë‚´ ì§‘
- **EC2**: í´ë¼ìš°ë“œì— ë¹Œë¦° ì‚¬ë¬´ì‹¤

**EC2ì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²ƒë“¤:**

```
EC2 ì¸ìŠ¤í„´ìŠ¤ (t4g.micro)
  â”œâ”€â”€ Amazon Linux 2023 (OS)
  â”œâ”€â”€ Docker
  â””â”€â”€ Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜
      â”œâ”€â”€ RDS ì—°ê²° â†’
      â”œâ”€â”€ Redis ì—°ê²° â†’
      â””â”€â”€ S3 ì—°ê²° â†’
```

**ì™œ EC2ë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?**

- âœ… **24ì‹œê°„ ì‹¤í–‰**: ì„œë²„ê°€ í•­ìƒ ì¼œì ¸ ìˆìŒ
- âœ… **ê³ ì • IP**: Elastic IPë¡œ ì£¼ì†Œ ê³ ì •
- âœ… **í™•ì¥ì„±**: í•„ìš”í•˜ë©´ CPU/ë©”ëª¨ë¦¬ ì¦ì„¤
- âœ… **ì•ˆì •ì„±**: AWS ë°ì´í„°ì„¼í„°ì—ì„œ ê´€ë¦¬

**t4g.micro ì„ íƒ ì´ìœ :**

- ARM ê¸°ë°˜ â†’ ì €ë ´ ($6/ì›”)
- ê°œë°œ í™˜ê²½ì— ì¶©ë¶„í•œ ì„±ëŠ¥ (1 vCPU, 1GB RAM)
- ìš´ì˜ ì „í™˜ ì‹œ ìŠ¤í™ë§Œ ì˜¬ë¦¬ë©´ ë¨

---

**AWS ì½˜ì†” â†’ EC2 â†’ ì¸ìŠ¤í„´ìŠ¤ â†’ ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘**

### 6.1 ì´ë¦„ ë° íƒœê·¸

```
ì´ë¦„: atwoz-dev-server
```

### 6.2 ì• í”Œë¦¬ì¼€ì´ì…˜ ë° OS ì´ë¯¸ì§€ (AMI)

```
ë¹ ë¥¸ ì‹œì‘: Amazon Linux
Amazon Machine Image: Amazon Linux 2023 AMI
ì•„í‚¤í…ì²˜: 64ë¹„íŠ¸ (Arm)
```

### 6.3 ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•

```
ì¸ìŠ¤í„´ìŠ¤ ìœ í˜•: t4g.micro
  (1 vCPU, 1 GiB ë©”ëª¨ë¦¬)
```

### 6.4 í‚¤ í˜ì–´

```
í‚¤ í˜ì–´ ìƒì„± í´ë¦­

í‚¤ í˜ì–´ ì´ë¦„: atwoz-dev-keypair
í‚¤ í˜ì–´ ìœ í˜•: RSA
í”„ë¼ì´ë¹— í‚¤ íŒŒì¼ í˜•ì‹: .pem

â†’ í‚¤ í˜ì–´ ìƒì„±
```

âš ï¸ **.pem íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë©ë‹ˆë‹¤. ì•ˆì „í•œ ê³³ì— ë³´ê´€í•˜ì„¸ìš”!**

### 6.5 ë„¤íŠ¸ì›Œí¬ ì„¤ì •

```
VPC: [ì„ íƒí•œ VPC]

ì„œë¸Œë„·: ê¸°ë³¸ ì„¤ì • ì—†ìŒ

í¼ë¸”ë¦­ IP ìë™ í• ë‹¹: í™œì„±í™”

ë°©í™”ë²½(ë³´ì•ˆ ê·¸ë£¹):
  ê¸°ì¡´ ë³´ì•ˆ ê·¸ë£¹ ì„ íƒ
  â†’ atwoz-dev-ec2-sg ì„ íƒ
```

### 6.6 ìŠ¤í† ë¦¬ì§€ êµ¬ì„±

```
ë³¼ë¥¨ 1 (ë£¨íŠ¸):
  í¬ê¸°: 20 GiB
  ë³¼ë¥¨ ìœ í˜•: gp3
```

### 6.7 ê³ ê¸‰ ì„¸ë¶€ ì •ë³´

```
IAM ì¸ìŠ¤í„´ìŠ¤ í”„ë¡œíŒŒì¼:
  (ì¼ë‹¨ ë¹„ì›Œë‘ê³  ë‚˜ì¤‘ì— ì„¤ì •)
```

**â†’ ì¸ìŠ¤í„´ìŠ¤ ì‹œì‘ í´ë¦­!**

### 6.8 Elastic IP í• ë‹¹ (ê¶Œì¥)

ê³ ì • IP ì£¼ì†Œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´:

**EC2 â†’ ë„¤íŠ¸ì›Œí¬ ë° ë³´ì•ˆ â†’ íƒ„ë ¥ì  IP â†’ íƒ„ë ¥ì  IP ì£¼ì†Œ í• ë‹¹**

```
â†’ í• ë‹¹ í´ë¦­
```

í• ë‹¹ëœ IP ì„ íƒ â†’ ì‘ì—… â†’ íƒ„ë ¥ì  IP ì£¼ì†Œ ì—°ê²°

```
ë¦¬ì†ŒìŠ¤ ìœ í˜•: ì¸ìŠ¤í„´ìŠ¤
ì¸ìŠ¤í„´ìŠ¤: atwoz-dev-server ì„ íƒ

â†’ ì—°ê²° í´ë¦­
```

### 6.9 IAM ì—­í•  ìƒì„± (ECR ì ‘ê·¼ìš©)

**AWS ì½˜ì†” â†’ IAM â†’ ì—­í•  â†’ ì—­í•  ë§Œë“¤ê¸°**

```
ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì—”í„°í‹° ìœ í˜•: AWS ì„œë¹„ìŠ¤
ì‚¬ìš© ì‚¬ë¡€: EC2
```

**ë‹¤ìŒ í´ë¦­**

**ê¶Œí•œ ì •ì±…:**

```
ê²€ìƒ‰ì°½ì— ì…ë ¥ í›„ ì²´í¬:
  â˜‘ AmazonEC2ContainerRegistryReadOnly
  â˜‘ AmazonS3FullAccess (S3 ì‚¬ìš©í•˜ëŠ” ê²½ìš°)
```

**ë‹¤ìŒ í´ë¦­**

```
ì—­í•  ì´ë¦„: atwoz-dev-ec2-role
ì„¤ëª…: atwoz ê°œë°œ ì„œë²„ EC2 ì—­í• 

â†’ ì—­í•  ìƒì„± í´ë¦­
```

**ì—­í• ì„ EC2ì— ì—°ê²°:**

EC2 â†’ ì¸ìŠ¤í„´ìŠ¤ â†’ atwoz-dev-server ì„ íƒ
â†’ ì‘ì—… â†’ ë³´ì•ˆ â†’ IAM ì—­í•  ìˆ˜ì •
â†’ atwoz-dev-ec2-role ì„ íƒ
â†’ IAM ì—­í•  ì—…ë°ì´íŠ¸

---

### 6.10 EC2 ì ‘ì† ë° í™˜ê²½ ì„¤ì •

**ë¡œì»¬ í„°ë¯¸ë„ì—ì„œ:**

```bash
# í‚¤ í˜ì–´ íŒŒì¼ ê¶Œí•œ ì„¤ì • (ì²˜ìŒ í•œ ë²ˆë§Œ)
chmod 400 atwoz-dev-keypair.pem

# SSH ì ‘ì†
ssh -i atwoz-dev-keypair.pem ec2-user@[EC2 í¼ë¸”ë¦­ IP]
```

**EC2ì— ì ‘ì† í›„:**

#### Docker ì„¤ì¹˜

```bash
# ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸
sudo yum update -y

# Docker ì„¤ì¹˜
sudo yum install -y docker

# Docker ì‹œì‘
sudo systemctl start docker
sudo systemctl enable docker

# ec2-userë¥¼ docker ê·¸ë£¹ì— ì¶”ê°€
sudo usermod -a -G docker ec2-user

# ì¬ë¡œê·¸ì¸ (ê¶Œí•œ ì ìš©)
exit
ssh -i atwoz-dev-keypair.pem ec2-user@[EC2 í¼ë¸”ë¦­ IP]

# í™•ì¸
docker --version
```

#### Docker Compose ì„¤ì¹˜

```bash
# Docker Compose ë‹¤ìš´ë¡œë“œ (ARM64ìš©)
sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-linux-aarch64" -o /usr/local/bin/docker-compose

# ì‹¤í–‰ ê¶Œí•œ
sudo chmod +x /usr/local/bin/docker-compose

# í™•ì¸
docker-compose --version
```

---

## 7. ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬

### 7.1 ë¡œì»¬ì—ì„œ Docker ì´ë¯¸ì§€ ë¹Œë“œ

**í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ:**

```bash
# Dockerfile í™•ì¸
ls Dockerfile

# ARM64ìš© ì´ë¯¸ì§€ ë¹Œë“œ
docker buildx build --platform linux/arm64 -t atwoz:dev .
```

### 7.2 ECR ë¡œê·¸ì¸ ë° í‘¸ì‹œ

**ë¨¼ì € AWS ê³„ì • ID í™•ì¸:**

AWS ì½˜ì†” ìš°ì¸¡ ìƒë‹¨ ê³„ì • ì´ë¦„ í´ë¦­ â†’ ê³„ì • ID í™•ì¸ (12ìë¦¬ ìˆ«ì)

**ECR ë¡œê·¸ì¸ (AWS CLI í•„ìš”):**

```bash
# macOSì—ì„œ
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com
```

**ì´ë¯¸ì§€ íƒœê¹… ë° í‘¸ì‹œ:**

```bash
# íƒœê¹…
docker tag atwoz:dev [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev:latest

# í‘¸ì‹œ
docker push [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev:latest
```

### 7.3 í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ ìƒì„±

**ë¡œì»¬ì—ì„œ `.env.dev` íŒŒì¼ ìƒì„±:**

```bash
# Spring profiles
SPRING_PROFILES_ACTIVE=dev

# RDS MySQL (ìœ„ì—ì„œ ë©”ëª¨í•œ ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©)
MYSQL_HOST=atwoz-dev-db.xxxxxx.ap-northeast-2.rds.amazonaws.com
MYSQL_PORT=3306
MYSQL_DATABASE=atwoz_dev
MYSQL_USER=admin
MYSQL_PASSWORD=[RDS ìƒì„± ì‹œ ì„¤ì •í•œ ë¹„ë°€ë²ˆí˜¸]

# ElastiCache Redis (ìœ„ì—ì„œ ë©”ëª¨í•œ ì—”ë“œí¬ì¸íŠ¸ ì‚¬ìš©)
REDIS_HOST=atwoz-dev-redis.xxxxxx.cache.amazonaws.com
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_SSL_ENABLED=true

# JPA/Flyway
JPA_DDL_AUTO=validate
JPA_SHOW_SQL=false
JPA_FORMAT_SQL=false
FLYWAY_ENABLED=true

# Server
SERVER_PORT=8080

# AWS S3 (EC2 IAM Role ì‚¬ìš©)
AWS_S3_BUCKET_NAME=atwoz-dev-bucket
# AWS_S3_ACCESS_KEYëŠ” ë¶ˆí•„ìš” (IAM Role ì‚¬ìš©)
# AWS_S3_SECRET_KEYëŠ” ë¶ˆí•„ìš” (IAM Role ì‚¬ìš©)

# JWT
JWT_SECRET=[ê°•ë ¥í•œ ëœë¤ ë¬¸ìì—´ - ìµœì†Œ 128ë°”ì´íŠ¸]
JWT_ACCESS_TOKEN_EXPIRATION=1800
JWT_REFRESH_TOKEN_EXPIRATION=1209600

# Auth
AUTH_PREFIX_CODE=008008

# Swagger
SPRINGDOC_ENABLED=true
SWAGGER_UI_ENABLED=true

# App Store (ê¸°ì¡´ .envì—ì„œ ë³µì‚¬)
APP_STORE_KEY_ID=T2X6XS75G3
APP_STORE_PRIVATE_KEY_STRING=[Base64 ì¸ì½”ë”©ëœ í‚¤]
APP_STORE_ISSUER_ID=0e0cd7c8-8a8f-477b-ad14-fcb32c2a8fd9
APP_STORE_ENVIRONMENT=Sandbox
APP_STORE_BUNDLE_ID=com.goodmeet.atwoz
APP_STORE_APP_APPLE_ID=0000000000
APP_STORE_ROOT_CA_G2_PATH=/etc/certs/appstore/AppleRootCA-G2.pem
APP_STORE_ROOT_CA_G3_PATH=/etc/certs/appstore/AppleRootCA-G3.pem
APP_STORE_BASE_URL=https://api.storekit-sandbox.itunes.apple.com

# Bizgo (ì‹¤ì œ ê°’ìœ¼ë¡œ ë³€ê²½)
BIZGO_API_URL=
BIZGO_CLIENT_ID=
BIZGO_CLIENT_PASSWORD=
BIZGO_FROM_PHONE_NUMBER=

# Firebase
GOOGLE_APPLICATION_CREDENTIALS=/etc/credentials/atwoz-firebase.json
```

### 7.4 EC2ì— íŒŒì¼ ì—…ë¡œë“œ

**ë¡œì»¬ì—ì„œ:**

```bash
# .env.dev ì—…ë¡œë“œ
scp -i atwoz-dev-keypair.pem .env.dev ec2-user@[EC2 IP]:~/

# secrets í´ë” ì—…ë¡œë“œ
scp -i atwoz-dev-keypair.pem -r ./secrets ec2-user@[EC2 IP]:~/

# certs í´ë” ì—…ë¡œë“œ
scp -i atwoz-dev-keypair.pem -r ./certs ec2-user@[EC2 IP]:~/
```

### 7.5 EC2ì—ì„œ docker-compose.yml ìƒì„±

**EC2 SSH ì ‘ì† í›„:**

```bash
# ì‘ì—… ë””ë ‰í† ë¦¬ ìƒì„±
mkdir -p ~/atwoz
cd ~/atwoz

# .env íŒŒì¼ ë³µì‚¬
cp ~/.env.dev .env

# secrets, certs ì´ë™
mv ~/secrets ~/certs ~/atwoz/

# docker-compose.yml ìƒì„±
cat > docker-compose.yml << 'EOF'
version: '3.9'

services:
  app:
    image: [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev:latest
    container_name: atwoz-app
    env_file:
      - .env
    ports:
      - "8080:8080"
    volumes:
      - ./secrets:/etc/credentials:ro
      - ./certs:/etc/certs:ro
    restart: unless-stopped
EOF
```

**ì¤‘ìš”: `[ê³„ì •ID]`ë¥¼ ì‹¤ì œ AWS ê³„ì • IDë¡œ ë³€ê²½!**

```bash
# íŒŒì¼ í¸ì§‘
vi docker-compose.yml
# ë˜ëŠ”
nano docker-compose.yml
```

### 7.6 ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰

```bash
# ECR ë¡œê·¸ì¸ (EC2ì—ì„œ)
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com

# ì´ë¯¸ì§€ pull
docker-compose pull

# ì‹¤í–‰
docker-compose up -d

# ë¡œê·¸ í™•ì¸
docker-compose logs -f
```

---

## 8. ë™ì‘ í™•ì¸ ë° í…ŒìŠ¤íŠ¸

### 8.1 í—¬ìŠ¤ ì²´í¬

**EC2 ë‚´ë¶€ì—ì„œ:**

```bash
curl http://localhost:8080/actuator/health
```

**ë¡œì»¬ì—ì„œ:**

```bash
curl http://[EC2 í¼ë¸”ë¦­ IP]:8080/actuator/health
```

ì˜ˆìƒ ì‘ë‹µ:

```json
{
  "status": "UP"
}
```

### 8.2 Swagger UI

ë¸Œë¼ìš°ì €ì—ì„œ:

```
http://[EC2 í¼ë¸”ë¦­ IP]:8080/swagger-ui.html
```

### 8.3 Flyway ë§ˆì´ê·¸ë ˆì´ì…˜ í™•ì¸

```bash
docker-compose logs app | grep -i flyway
```

ì„±ê³µ ì‹œ: `Successfully applied X migration(s)` ê°™ì€ ë©”ì‹œì§€ í™•ì¸

---

## 9. Nginx + Let's Encrypt HTTPS ì„¤ì •

### ğŸ’¡ ì™œ Nginxê°€ í•„ìš”í•œê°€ìš”?

**í˜„ì¬ ìƒíƒœ:**

```
ì¸í„°ë„· â†’ EC2:8080 â†’ Spring Boot (HTTPë§Œ ê°€ëŠ¥)
```

**HTTPS ì ìš© í›„:**

```
ì¸í„°ë„· â†’ EC2:443 (HTTPS) â†’ Nginx â†’ Spring Boot:8080 (HTTP)
```

**Nginx = ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ + SSL í„°ë¯¸ë„¤ì´ì…˜**

**ë¹„ìœ : í˜¸í…” í”„ë¡ íŠ¸ ë°ìŠ¤í¬**

- **Spring Boot**: ê°ì‹¤ (ì‹¤ì œ ì„œë¹„ìŠ¤)
- **Nginx**: í”„ë¡ íŠ¸ ë°ìŠ¤í¬ (ì†ë‹˜ ë§ì´, ë³´ì•ˆ ì²´í¬, ê°ì‹¤ë¡œ ì•ˆë‚´)

**Nginxê°€ í•˜ëŠ” ì¼:**

1. âœ… **SSL/TLS ì²˜ë¦¬**: HTTPS ì•”í˜¸í™”/ë³µí˜¸í™”
2. âœ… **ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ**: ì™¸ë¶€ ìš”ì²­ì„ Spring Bootë¡œ ì „ë‹¬
3. âœ… **ë¡œë“œ ë°¸ëŸ°ì‹±**: ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ë¡œ ë¶„ì‚° (ë‚˜ì¤‘ì—)
4. âœ… **ì •ì  íŒŒì¼ ì„œë¹™**: ì´ë¯¸ì§€, CSS ë“± (ì„ íƒì‚¬í•­)

---

### 9.1 Nginx ì„¤ì¹˜

**EC2 SSH ì ‘ì† í›„:**

```bash
# Nginx ì„¤ì¹˜
sudo yum install -y nginx

# Nginx ì‹œì‘
sudo systemctl start nginx
sudo systemctl enable nginx

# í™•ì¸
sudo systemctl status nginx
```

**í…ŒìŠ¤íŠ¸:**
ë¸Œë¼ìš°ì €ì—ì„œ `http://[EC2 IP]` ì ‘ì† â†’ Nginx í™˜ì˜ í˜ì´ì§€ê°€ ë³´ì´ë©´ ì„±ê³µ!

---

### 9.2 Nginx ì„¤ì • íŒŒì¼ ìƒì„±

#### 9.2.1 ê¸°ë³¸ HTTP í”„ë¡ì‹œ ì„¤ì •

**ë¨¼ì € HTTP í”„ë¡ì‹œ ì„¤ì •:**

```bash
# ê¸°ì¡´ ì„¤ì • ë°±ì—…
sudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup

# ìƒˆ ì„¤ì • íŒŒì¼ ìƒì„±
sudo tee /etc/nginx/conf.d/atwoz-dev.conf > /dev/null << 'EOF'
server {
    listen 80;
    server_name dev.atwoz.com;  # ë³¸ì¸ ë„ë©”ì¸ìœ¼ë¡œ ë³€ê²½

    # ë¡œê·¸
    access_log /var/log/nginx/atwoz-dev.access.log;
    error_log /var/log/nginx/atwoz-dev.error.log;

    # Spring Bootë¡œ í”„ë¡ì‹œ
    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # WebSocket ì§€ì› (í•„ìš”í•œ ê²½ìš°)
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # íƒ€ì„ì•„ì›ƒ
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # íŒŒì¼ ì—…ë¡œë“œ í¬ê¸° ì œí•œ
    client_max_body_size 50M;
}
EOF
```

**ì„¤ì • í™•ì¸ ë° ì¬ì‹œì‘:**

```bash
# ì„¤ì • íŒŒì¼ ë¬¸ë²• ê²€ì‚¬
sudo nginx -t

# Nginx ì¬ì‹œì‘
sudo systemctl restart nginx

# ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/nginx/atwoz-dev.error.log
```

**í…ŒìŠ¤íŠ¸:**

```bash
# ë„ë©”ì¸ìœ¼ë¡œ ì ‘ê·¼ (HTTP)
curl http://dev.atwoz.com/actuator/health
```

ì‘ë‹µì´ ì˜¤ë©´ ì„±ê³µ! ì´ì œ HTTPSë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

---

### 9.3 Let's Encrypt SSL ì¸ì¦ì„œ ë°œê¸‰

#### 9.3.1 Certbot ì„¤ì¹˜

```bash
# EPEL ë¦¬í¬ì§€í† ë¦¬ ì¶”ê°€
sudo yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm

# Certbot ì„¤ì¹˜
sudo yum install -y certbot python3-certbot-nginx

# í™•ì¸
certbot --version
```

#### 9.3.2 SSL ì¸ì¦ì„œ ë°œê¸‰

âš ï¸ **ì£¼ì˜ì‚¬í•­:**

1. **ë„ë©”ì¸ì˜ A ë ˆì½”ë“œ**ê°€ ì´ë¯¸ EC2 IPë¥¼ ê°€ë¦¬ì¼œì•¼ í•©ë‹ˆë‹¤ (ì„¹ì…˜ 6.4 ì™„ë£Œ í•„ìˆ˜)
2. **EC2 ë³´ì•ˆ ê·¸ë£¹**ì—ì„œ 80, 443 í¬íŠ¸ê°€ ì—´ë ¤ ìˆì–´ì•¼ í•©ë‹ˆë‹¤

```bash
# SSL ì¸ì¦ì„œ ë°œê¸‰ ë° ìë™ Nginx ì„¤ì •
sudo certbot --nginx -d dev.atwoz.com

# í”„ë¡¬í”„íŠ¸ì—ì„œ ì…ë ¥:
# 1. ì´ë©”ì¼ ì£¼ì†Œ: [ë³¸ì¸ ì´ë©”ì¼] (ì¸ì¦ì„œ ë§Œë£Œ ì•Œë¦¼ìš©)
# 2. ì•½ê´€ ë™ì˜: Y
# 3. ì´ë©”ì¼ ìˆ˜ì‹  ë™ì˜: N (ì„ íƒ)
```

**ì„±ê³µ ë©”ì‹œì§€:**

```
Successfully received certificate.
Certificate is saved at: /etc/letsencrypt/live/dev.atwoz.com/fullchain.pem
Key is saved at:         /etc/letsencrypt/live/dev.atwoz.com/privkey.pem
```

#### 9.3.3 Certbotì´ ìˆ˜ì •í•œ Nginx ì„¤ì • í™•ì¸

```bash
# Nginx ì„¤ì • í™•ì¸
sudo cat /etc/nginx/conf.d/atwoz-dev.conf
```

Certbotì´ ìë™ìœ¼ë¡œ ë‹¤ìŒì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤:

- HTTPS ì„œë²„ ë¸”ë¡ (443 í¬íŠ¸)
- SSL ì¸ì¦ì„œ ê²½ë¡œ
- HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸

**í…ŒìŠ¤íŠ¸:**

```bash
# HTTPSë¡œ ì ‘ê·¼
curl https://dev.atwoz.com/actuator/health

# ë¸Œë¼ìš°ì €ì—ì„œ
# https://dev.atwoz.com/swagger-ui.html
```

ğŸ”’ **ìë¬¼ì‡  ì•„ì´ì½˜**ì´ ë³´ì´ë©´ ì„±ê³µ!

---

### 9.4 ì¸ì¦ì„œ ìë™ ê°±ì‹  ì„¤ì •

Let's Encrypt ì¸ì¦ì„œëŠ” **90ì¼**ë§ˆë‹¤ ë§Œë£Œë©ë‹ˆë‹¤. ìë™ ê°±ì‹  ì„¤ì •:

```bash
# ê°±ì‹  í…ŒìŠ¤íŠ¸ (ì‹¤ì œë¡œ ê°±ì‹ í•˜ì§€ ì•ŠìŒ)
sudo certbot renew --dry-run

# ì„±ê³µí•˜ë©´ ìë™ ê°±ì‹  ì„¤ì • ì™„ë£Œ!
# Amazon Linux 2023ì€ systemd íƒ€ì´ë¨¸ë¡œ ìë™ ê°±ì‹ ë¨
```

**ìë™ ê°±ì‹  í™•ì¸:**

```bash
# systemd íƒ€ì´ë¨¸ í™•ì¸
sudo systemctl list-timers | grep certbot

# ë˜ëŠ” cron í™•ì¸
sudo cat /etc/cron.d/certbot
```

---

### 9.5 Nginx ìµœì¢… ì„¤ì • ìµœì í™”

Certbotì´ ìƒì„±í•œ ì„¤ì •ì„ ì•½ê°„ ìµœì í™”í•©ë‹ˆë‹¤:

```bash
# ì„¤ì • íŒŒì¼ í¸ì§‘
sudo vi /etc/nginx/conf.d/atwoz-dev.conf
```

**ìµœì¢… ì„¤ì • ì˜ˆì‹œ:**

```nginx
# HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸
server {
    listen 80;
    server_name dev.atwoz.com;

    # Let's Encrypt ì¸ì¦ì„œ ê°±ì‹ ìš©
    location /.well-known/acme-challenge/ {
        root /var/www/certbot;
    }

    # ëª¨ë“  HTTP ìš”ì²­ì„ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
    location / {
        return 301 https://$server_name$request_uri;
    }
}

# HTTPS ì„œë²„
server {
    listen 443 ssl http2;
    server_name dev.atwoz.com;

    # SSL ì¸ì¦ì„œ
    ssl_certificate /etc/letsencrypt/live/dev.atwoz.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/dev.atwoz.com/privkey.pem;

    # SSL ì„¤ì • (Certbot ìë™ ìƒì„±)
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # ë¡œê·¸
    access_log /var/log/nginx/atwoz-dev.access.log;
    error_log /var/log/nginx/atwoz-dev.error.log;

    # Spring Bootë¡œ í”„ë¡ì‹œ
    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-Host $host;

        # WebSocket ì§€ì›
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # íƒ€ì„ì•„ì›ƒ
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }

    # íŒŒì¼ ì—…ë¡œë“œ í¬ê¸° ì œí•œ
    client_max_body_size 50M;
}
```

**ì¬ì‹œì‘:**

```bash
sudo nginx -t && sudo systemctl restart nginx
```

---

### 9.6 ë°©í™”ë²½ ì„¤ì • (ì„ íƒì‚¬í•­)

Amazon Linux 2023ì€ ê¸°ë³¸ì ìœ¼ë¡œ firewalldê°€ ë¹„í™œì„±í™”ë˜ì–´ ìˆì§€ë§Œ, í™•ì¸:

```bash
# firewalld ìƒíƒœ í™•ì¸
sudo systemctl status firewalld

# ë§Œì•½ í™œì„±í™”ë˜ì–´ ìˆë‹¤ë©´:
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload
```

---

## 10. ìµœì¢… ë™ì‘ í™•ì¸

### 10.1 HTTPS ì ‘ì† í…ŒìŠ¤íŠ¸

**ë¸Œë¼ìš°ì €ì—ì„œ:**

```
https://dev.atwoz.com/swagger-ui.html
```

**í™•ì¸ ì‚¬í•­:**

- [ ] ğŸ”’ ìë¬¼ì‡  ì•„ì´ì½˜ í‘œì‹œ
- [ ] HTTP â†’ HTTPS ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸
- [ ] API ì •ìƒ ì‘ë™
- [ ] Swagger UI ì ‘ì† ê°€ëŠ¥

**ëª…ë ¹ì¤„ì—ì„œ:**

```bash
# SSL ì¸ì¦ì„œ í™•ì¸
curl -vI https://dev.atwoz.com 2>&1 | grep -i 'subject\|issuer'

# Health check
curl https://dev.atwoz.com/actuator/health

# HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸ í™•ì¸
curl -I http://dev.atwoz.com
# â†’ 301 Moved Permanently
```

### 10.2 ì „ì²´ êµ¬ì¡° í™•ì¸

```
ì‚¬ìš©ì
  â†“ HTTPS (443)
Nginx (EC2)
  â†“ HTTP (8080)
Spring Boot (Docker)
  â†“
RDS MySQL (3306)
  â†“
ElastiCache Redis (6379)
```

---

## 11. ë¬¸ì œ í•´ê²°

### 9.1 ì»¨í…Œì´ë„ˆê°€ ì‹œì‘ ì•ˆ ë¨

```bash
# ë¡œê·¸ í™•ì¸
docker-compose logs app

# í™˜ê²½ ë³€ìˆ˜ í™•ì¸
docker-compose config

# ì¬ì‹œì‘
docker-compose restart app
```

### 9.2 RDS ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:** `Communications link failure`

**í•´ê²°:**

1. RDS ë³´ì•ˆ ê·¸ë£¹ì—ì„œ EC2 ë³´ì•ˆ ê·¸ë£¹ í—ˆìš© í™•ì¸
2. RDS ì—”ë“œí¬ì¸íŠ¸ ì£¼ì†Œ í™•ì¸
3. EC2ì—ì„œ ì—°ê²° í…ŒìŠ¤íŠ¸:

```bash
# MySQL í´ë¼ì´ì–¸íŠ¸ ì„¤ì¹˜
sudo yum install -y mysql

# ì—°ê²° í…ŒìŠ¤íŠ¸
mysql -h atwoz-dev-db.xxxxxx.rds.amazonaws.com -u admin -p
```

### 9.3 Redis ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ:** `Could not connect to Redis`

**í•´ê²°:**

```bash
# redis-cli ì„¤ì¹˜
sudo yum install -y redis6

# ì—°ê²° í…ŒìŠ¤íŠ¸
redis-cli -h atwoz-dev-redis.xxxxxx.cache.amazonaws.com
```

### 9.4 ë©”ëª¨ë¦¬ ë¶€ì¡±

```bash
# JVM ë©”ëª¨ë¦¬ ì œí•œ ì„¤ì •
# docker-compose.ymlì— ì¶”ê°€:
services:
  app:
    environment:
      - JAVA_OPTS=-Xmx512m -Xms256m
```

### 9.5 ì´ë¯¸ì§€ pull ì‹¤íŒ¨

**ì¦ìƒ:** `unauthorized: authentication required`

**í•´ê²°:**

```bash
# ECR ì¬ë¡œê·¸ì¸
aws ecr get-login-password --region ap-northeast-2 | docker login --username AWS --password-stdin [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com

# IAM ì—­í•  í™•ì¸ (EC2ì— ECR ì½ê¸° ê¶Œí•œ ìˆëŠ”ì§€)
```

---

## 10. ìƒˆ ë²„ì „ ë°°í¬

ë¡œì»¬ì—ì„œ ì½”ë“œ ìˆ˜ì • í›„ ë°°í¬:

```bash
# 1. ë¡œì»¬ì—ì„œ ë¹Œë“œ & í‘¸ì‹œ
docker buildx build --platform linux/arm64 -t atwoz:dev .
docker tag atwoz:dev [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev:latest
docker push [ê³„ì •ID].dkr.ecr.ap-northeast-2.amazonaws.com/atwoz/dev:latest

# 2. EC2ì—ì„œ ì—…ë°ì´íŠ¸
ssh -i atwoz-dev-keypair.pem ec2-user@[EC2 IP]
cd ~/atwoz
docker-compose pull
docker-compose up -d
docker-compose logs -f
```

---

## ë¶€ë¡: ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°°í¬ ì „

- [ ] IAM ê¶Œí•œ í™•ì¸ (AdministratorAccess)
- [ ] VPC ID ë©”ëª¨
- [ ] ë³´ì•ˆ ê·¸ë£¹ 3ê°œ ìƒì„± (EC2, RDS, Redis)
- [ ] RDS ì—”ë“œí¬ì¸íŠ¸ ë©”ëª¨
- [ ] Redis ì—”ë“œí¬ì¸íŠ¸ ë©”ëª¨
- [ ] ECR ë¦¬í¬ì§€í† ë¦¬ ìƒì„±
- [ ] EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- [ ] IAM ì—­í•  ìƒì„± ë° ì—°ê²°
- [ ] .env.dev íŒŒì¼ ì‘ì„±
- [ ] secrets, certs íŒŒì¼ ì¤€ë¹„

### ë°°í¬ í›„

- [ ] ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ í™•ì¸
- [ ] Health check API ì‘ë‹µ í™•ì¸
- [ ] Swagger UI ì ‘ì† í™•ì¸
- [ ] Flyway ë§ˆì´ê·¸ë ˆì´ì…˜ ì„±ê³µ
- [ ] RDS ì—°ê²° í™•ì¸
- [ ] Redis ì—°ê²° í™•ì¸
- [ ] API ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

---

## ì°¸ê³  ìë£Œ

- [AWS EC2 ë¬¸ì„œ](https://docs.aws.amazon.com/ec2/)
- [AWS RDS MySQL](https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/CHAP_MySQL.html)
- [AWS ElastiCache Redis](https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/)